#!/usr/bin/env elixir

if not File.exists?(".env") do
  IO.puts("Please create a .env file at the root of the project.")
  IO.puts("See .example.env for an example.")
  System.halt(1)
end

alias Harvester.Modules.Harvest

env = Dotenv.load!() |> then(& &1.values)

if is_nil(env["HARVEST_ACCOUNT_ID"]) or is_nil(env["HARVEST_API_TOKEN"]) do
  IO.puts("Please set HARVEST_ACCOUNT_ID and HARVEST_API_TOKEN in your .env file.")
  System.halt(1)
end

%{"HARVEST_ACCOUNT_ID" => account_id, "HARVEST_API_TOKEN" => api_token} = env

user = Harvest.get_authenticated_user!(account_id, api_token)

IO.inspect(user.id)







